name: Monitor MOE Files via Telegram

on:
  # ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† ÙƒÙ„ Ù†ØµÙ Ø³Ø§Ø¹Ø© (Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© 0 ÙˆØ§Ù„Ø¯Ù‚ÙŠÙ‚Ø© 30 Ù…Ù† ÙƒÙ„ Ø³Ø§Ø¹Ø©)
  schedule:
    - cron: '0 * * * *'   # ØªØ´ØºÙŠÙ„ ÙÙŠ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© 0 Ù…Ù† ÙƒÙ„ Ø³Ø§Ø¹Ø©
    - cron: '30 * * * *'  # ØªØ´ØºÙŠÙ„ ÙÙŠ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© 30 Ù…Ù† ÙƒÙ„ Ø³Ø§Ø¹Ø©
    
  # ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ
  workflow_dispatch: 

jobs:
  # ... (Ø¨Ù‚ÙŠØ© Ø§Ù„ÙƒÙˆØ¯ ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ)

  run_scraper:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11' 
          
      - name: Install dependencies
        run: pip install -r requirements.txt
        
      - name: Run Scraper Script
        # ØªÙ…Ø±ÙŠØ± Ø§Ù„ØªÙˆÙƒÙ† ÙÙ‚Ø·
        run: python monitor.py
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        
       - name: Commit history file
        # Ø§Ù„Ø£Ù‡Ù…: Ø¥ØµÙ„Ø§Ø­ Ø®Ø·ÙˆØ© Ø­ÙØ¸ Ù…Ù„Ù Ø§Ù„Ø³Ø¬Ù„
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Automatic update: Update file history after scraping."
          file_pattern: moe_files_history.txt  # ğŸš¨ ØªÙ… ØªØºÙŠÙŠØ± "files" Ø¥Ù„Ù‰ "file_pattern"
